---
- hosts: all
  pre_tasks:
    - name: ensure curl is installed
      package:
        name: curl
    - name: ensure dummy certificate exists
      command: /etc/pki/tls/certs/make-dummy-cert /etc/pki/tls/certs/example.com.crt
      args:
        creates: /etc/pki/tls/certs/example.com.crt
  roles:
    - mjanser.mysql
    - mjanser.nginx
    - mjanser.php
    - mjanser.owncloud
  vars:
    mysql_vendor: mariadb
    mysql_origin: upstream
    owncloud_ssl_certificate_key: "/etc/pki/tls/certs/example.com.crt"
    owncloud_config_defaultapp: "gallery,files"
    owncloud_config_trusted_domains: ["localhost", "example.com"]
    owncloud_restore_database: /vagrant/backup.sql
    owncloud_apps:
      - name: files_external
